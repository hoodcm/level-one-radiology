---
import Layout from '@/layouts/Layout.astro';
import ArticleCard from '@/components/shared/ArticleCard.astro';
import NewsletterSignup from '@/components/shared/NewsletterSignup.tsx';
import { getCollection } from 'astro:content';

const allArticles = await getCollection('articles');
const featuredArticles = allArticles
  .filter((a) => a.data.featured)
  .sort((a, b) => new Date(b.data.publishDate).getTime() - new Date(a.data.publishDate).getTime());

const leadArticle = featuredArticles[0];
const restArticles = featuredArticles.slice(1);
---

<Layout title="Level One Radiology — Independent Emergency Radiology">
  <!-- Hero -->
  <section class="hero">
    <div class="hero__inner">
      <p class="type-ui hero__label">Independent Emergency Radiology</p>
      <h1 class="type-display-l hero__tagline">Timely coverage meets educational rigor.</h1>
      <p class="type-body-secondary hero__value-prop">
        Substantive analysis of emergency radiology — clinical deep-dives, case-based education, and field commentary from a practicing radiologist. One article at a time.
      </p>
      <NewsletterSignup client:load variant="inline" />
    </div>
  </section>

  <!-- Featured Content -->
  {featuredArticles.length > 0 && (
    <section class="featured-section">
      <div class="featured-section__inner">
        <div class="featured-section__header">
          <h2 class="type-ui">Featured</h2>
        </div>
        <div class="featured-grid">
          {leadArticle && (
            <div class="featured-grid__lead">
              <ArticleCard
                title={leadArticle.data.title}
                description={leadArticle.data.description}
                publishDate={leadArticle.data.publishDate}
                primaryTag={leadArticle.data.primaryTag}
                contentType={leadArticle.data.contentType}
                slug={leadArticle.id}
                isLead={true}
              />
            </div>
          )}
          <div class="featured-grid__rest">
            {restArticles.map((article) => (
              <ArticleCard
                title={article.data.title}
                description={article.data.description}
                publishDate={article.data.publishDate}
                primaryTag={article.data.primaryTag}
                contentType={article.data.contentType}
                slug={article.id}
              />
            ))}
          </div>
        </div>
      </div>
    </section>
  )}
</Layout>
